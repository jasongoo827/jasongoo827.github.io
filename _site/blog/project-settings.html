<!DOCTYPE html>

<!--
  portfolYOU Jekyll theme by yousinix
  Free for personal and commercial use under the MIT license
  https://github.com/yousinix/portfolYOU
-->

<html lang="en" class="h-100">

<head>

  
  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="Game Engine Architecture - Project Settings">
  <meta property="og:description" content="ALEngine Project Settings 에 대한 글. CMake로 프로젝트 빌드를 어떻게 했는지 설명.">
  <meta property="og:image" content="https://avatars.githubusercontent.com/u/81475273?v=4">

  <title>Game Engine Architecture - Project Settings</title>
  <meta name="description" content="ALEngine Project Settings 에 대한 글. CMake로 프로젝트 빌드를 어떻게 했는지 설명.">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">

  <!-- Theme style -->
  <script src="/assets/js/theme.js"></script>

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css">

</head>


<body class="h-100 d-flex flex-column">

  <main class="flex-shrink-0 container mt-5">
    <nav class="navbar navbar-expand-lg navbar-themed">

  <a class="navbar-brand" href="/"><h5><b>jasongoo827</b></h5></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-1x fa-bars text-themed"></i>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto"><a class="nav-item nav-link " href="/CLAUDE">기술 블로그 프로젝트</a>

      <a class="nav-item nav-link " href="/projects/">Projects</a>

      <a class="nav-item nav-link active" href="/blog/">Blog</a>

      <a class="nav-item nav-link " href="/about/">About</a>

      

      <span id="theme-toggler" class="nav-item nav-link" role="button" onclick="toggleTheme()"></span>
    </div>
  </div>

</nav>
    <div class="col-lg-10 mx-auto mt-5 markdown-body">
  <div class="row">
  <!-- 본문 영역 -->
  <div class="col-md-9">
    <h1><b>Game Engine Architecture - Project Settings</b></h1>

    <p class="post-metadata text-muted">
      07 April 2025 -  
      <b>11 mins read time</b>

      <br>Tags: 
        
        <a class="text-decoration-none no-underline" href="/blog/tags#game-engine">
          <span class="tag badge badge-pill text-primary border border-primary">Game Engine</span>
        </a>
        
        <a class="text-decoration-none no-underline" href="/blog/tags#cmake">
          <span class="tag badge badge-pill text-primary border border-primary">CMake</span>
        </a>
        
        <a class="text-decoration-none no-underline" href="/blog/tags#makefile">
          <span class="tag badge badge-pill text-primary border border-primary">Makefile</span>
        </a>
        </p>

    <h2 id="project-settings">Project Settings</h2>
<p>프로젝트 환경 설정에 대한 글을 따로 쓰게 된 이유는, CMake라는 빌드 도구를 처음 써보며 배우게 된 점이 많기 때문이다. 이전에 42Seoul에서 과제를 할 때는 Makefile을 써 본게 전부이고, 42Seoul 전에는 Visual Studio의 빌드 도구를 썼었다. CMake 말고도 여러모로 배운 점들에 대해 상세히 기록해보려고 한다.</p>

<h2 id="cmake">CMake</h2>
<p>CMake는 C++이나 C 같은 컴파일 언어 프로젝트에서 빌드 시스템을 자동화하기 위해 사용되는 도구이다. 쉽게 말해서, 다양한 운영체제와 컴파일러에서 소스 코드를 컴파일하고 실행 파일을 만들 수 있도록 도와주는 설정 도구이다.</p>

<p><img src="https://cmake.org/wp-content/uploads/2023/08/CMake-Logo.svg" alt="CMake" /></p>

<h3 id="why-cmake">Why CMake?</h3>
<p>CMake를 쓰는 이유를 간단하게 정리해보면 다음과 같다.</p>

<h4 id="1-플랫폼컴파일러-독립적인-빌드-시스템-생성">1. <strong>플랫폼/컴파일러 독립적인 빌드 시스템 생성</strong></h4>
<ul>
  <li>하나의 CMake 설정 파일(<code class="language-plaintext highlighter-rouge">CMakeLists.txt</code>)만 있으면,
    <ul>
      <li>Windows에선 Visual Studio 프로젝트 생성</li>
      <li>Linux에선 Makefile 생성</li>
      <li>macOS에선 Xcode 프로젝트 생성</li>
    </ul>
  </li>
  <li>즉, 여러 운영체제에서 코드 하나로 크로스 플랫폼 개발이 가능해진다.</li>
</ul>

<h4 id="2-빌드-설정-자동화">2. <strong>빌드 설정 자동화</strong></h4>
<ul>
  <li>수동으로 많은 컴파일 명령어를 처리하는 것은 비효율적이다.</li>
  <li>CMake는 소스 파일, 라이브러리, 컴파일 옵션 등을 자동으로 처리해준다.</li>
  <li>복잡한 디렉터리 구조, 의존성, 모듈도 쉽게 다룰 수 있다.</li>
</ul>

<h4 id="3-프로젝트-규모가-커질수록-효과적">3. <strong>프로젝트 규모가 커질수록 효과적</strong></h4>
<ul>
  <li><strong>수십, 수백 개 파일이 있는 게임 프로젝트</strong>에서는 CMake가 거의 필수이다.</li>
  <li>모듈별로 타겟을 나누고, 의존성을 명확히 하여 유지보수와 협업이 쉬워짐.</li>
</ul>

<h4 id="4-외부-라이브러리-연동-간편">4. <strong>외부 라이브러리 연동 간편</strong></h4>
<ul>
  <li><code class="language-plaintext highlighter-rouge">find_package</code>, <code class="language-plaintext highlighter-rouge">target_link_libraries</code> 등을 통해 쉽게 연결 가능.</li>
  <li><code class="language-plaintext highlighter-rouge">FetchContent</code> 기능을 쓰면 GitHub에서 직접 다운로드해서 빌드까지 가능.</li>
</ul>

<h4 id="5-out-of-source-build">5. <strong>Out-of-source build</strong></h4>
<ul>
  <li>소스 디렉터리와 빌드 디렉터리를 분리 가능해서, 깔끔한 프로젝트 관리가 가능.</li>
  <li>예: <code class="language-plaintext highlighter-rouge">build/</code> 폴더 하나만 지우면 깨끗한 상태로 되돌릴 수 있음.</li>
</ul>

<hr />

<h2 id="프로젝트-파일-구조">프로젝트 파일 구조</h2>
<p>프로젝트는 AL, AL-ScriptCore, Sandbox, SandboxProject 총 4가지로 구성되어 있다. 각 프로젝트에 대해 설명하며 CMake 파일을 어떻게 작성했고, 그 과정에서 무엇을 고려했고 어떤 점이 어려웠는지 작성해보겠다.</p>

<h3 id="al">AL</h3>
<p>AfterLife Engine의 코어 시스템. Window, EventSystem, Profiler, Renderer, Physics, Memory, Scene, Scripting 등 코어한 모든 기능이 포함되어 있는 프로젝트이다.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AL/include
├── Core
├── Debug
├── Events
├── ImGui
├── Memory
├── Physics
├── Platform
├── Project
├── Renderer
├── Scene
├── Scripting
├── UI
└── Utils
</code></pre></div></div>

<h3 id="cmakeliststxt">CMakeLists.txt</h3>
<p>어차피 CMake 파일 명령어 사용법은 반복되는 부분이 많으니 이 부분에서 설명하고 넘어가겠다. AL의 CMake 파일을 보면서 설명하겠다.</p>

<div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cmake_minimum_required</span><span class="p">(</span>VERSION 3.20<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>PROJECT_NAME AfterLife<span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span><span class="p">)</span>

<span class="c1"># Set Macros</span>
<span class="nb">set</span><span class="p">(</span>WINDOW_NAME <span class="s2">"ALEngine"</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>WINDOW_WIDTH 1920<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>WINDOW_HEIGHT 1080<span class="p">)</span>

<span class="c1"># 의존성 설정</span>
<span class="nb">include</span><span class="p">(</span><span class="si">${</span><span class="nv">CMAKE_SOURCE_DIR</span><span class="si">}</span>/AL/Dependency.cmake<span class="p">)</span>

<span class="c1"># 소스 파일 및 헤더 파일 검색</span>
<span class="nb">file</span><span class="p">(</span>GLOB_RECURSE SOURCES <span class="s2">"</span><span class="si">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="si">}</span><span class="s2">/src/*.cpp"</span><span class="p">)</span>
<span class="nb">file</span><span class="p">(</span>GLOB_RECURSE HEADERS <span class="s2">"</span><span class="si">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="si">}</span><span class="s2">/include/*.h"</span><span class="p">)</span>

<span class="c1"># AL 라이브러리 생성</span>
<span class="nb">add_library</span><span class="p">(</span><span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span> STATIC <span class="si">${</span><span class="nv">SOURCES</span><span class="si">}</span><span class="p">)</span> <span class="c1"># SOURCES만 전달</span>

<span class="c1"># PCH 설정</span>
<span class="nb">target_precompile_headers</span><span class="p">(</span><span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span> PRIVATE <span class="si">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="si">}</span>/include/alpch.h<span class="p">)</span>

<span class="c1"># VulkanSDK 설정 - 설치 여부 확인 필요. 버전 확인 필요.</span>
<span class="nb">set</span><span class="p">(</span>CMAKE_PREFIX_PATH <span class="s2">"C:/VulkanSDK/1.3.296.0"</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span>Vulkan REQUIRED<span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span> PUBLIC Vulkan::Vulkan<span class="p">)</span>

<span class="c1"># 헤더 파일 경로 포함</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span> PUBLIC <span class="si">${</span><span class="nv">CMAKE_CURRENT_SOURCE_DIR</span><span class="si">}</span>/include<span class="p">)</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span> PUBLIC <span class="si">${</span><span class="nv">DEP_INCLUDE_DIR</span><span class="si">}</span><span class="p">)</span>

<span class="c1"># 시스템 라이브러리 추가 - 최소 환경 조건으로 명시하기(Visual Studio - Window SDK 설치)</span>
<span class="nb">set</span><span class="p">(</span>SYSTEM_LIBS WS2_32.lib WinMM.lib Version.lib Bcrypt.lib<span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span> PRIVATE <span class="si">${</span><span class="nv">SYSTEM_LIBS</span><span class="si">}</span><span class="p">)</span>

<span class="c1"># lib 경로 설정</span>
<span class="nb">target_link_directories</span><span class="p">(</span><span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span> PUBLIC <span class="si">${</span><span class="nv">DEP_LIB_DIR</span><span class="si">}</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span> PUBLIC <span class="si">${</span><span class="nv">DEP_LIBS</span><span class="si">}</span><span class="p">)</span>

<span class="c1"># AL의 컴파일 옵션 설정 (필요에 따라 추가)</span>
<span class="nb">target_compile_options</span><span class="p">(</span><span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span> PUBLIC <span class="s2">"/utf-8"</span><span class="p">)</span>

<span class="c1"># 매크로 정의</span>
<span class="nb">target_compile_definitions</span><span class="p">(</span><span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span> PUBLIC
WINDOW_NAME=<span class="s2">"</span><span class="si">${</span><span class="nv">WINDOW_NAME</span><span class="si">}</span><span class="s2">"</span>
WINDOW_WIDTH=<span class="si">${</span><span class="nv">WINDOW_WIDTH</span><span class="si">}</span>
WINDOW_HEIGHT=<span class="si">${</span><span class="nv">WINDOW_HEIGHT</span><span class="si">}</span><span class="p">)</span>

<span class="c1"># 출력 디렉토리 설정</span>
<span class="nb">set_target_properties</span><span class="p">(</span><span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span> PROPERTIES
    RUNTIME_OUTPUT_DIRECTORY <span class="si">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="si">}</span>/bin
    LIBRARY_OUTPUT_DIRECTORY <span class="si">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="si">}</span>/lib
    ARCHIVE_OUTPUT_DIRECTORY <span class="si">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="si">}</span>/lib
<span class="p">)</span>

<span class="c1"># Dependency들이 먼저 build 될 수 있게 관계 설정 / 뒤에서 부터 컴파일</span>
<span class="nb">add_dependencies</span><span class="p">(</span><span class="si">${</span><span class="nv">PROJECT_NAME</span><span class="si">}</span> <span class="si">${</span><span class="nv">DEP_LIST</span><span class="si">}</span><span class="p">)</span>

</code></pre></div></div>

<h3 id="사용된-명령어">사용된 명령어</h3>

<ul>
  <li>cmake_minimum_required : 사용하려는 최소 CMake 버전을 지정</li>
  <li>set: 변수 설정</li>
  <li>
    <p>project: 프로젝트 이름 설정</p>
  </li>
  <li>include: 의존성 설정. 보통 헤더 파일이나 Dependency 파일을 지정한다.</li>
  <li>CMAKE_SOURCE_DIR: 소스파일의 가장 top level의 경로</li>
  <li>GLOB_RECURSE: 하위 디렉터리를 포함하여 모든 파일을 재귀적으로 탐색</li>
  <li>
    <p>CMAKE_CURRENT_SOURCE_DIR: 현재 소스 경로</p>
  </li>
  <li>add_library: 라이브러리 생성</li>
  <li>
    <p>STATIC: 정적 라이브러리 옵션. SHARED를 사용하면 동적 라이브러리가 생긴다.</p>
  </li>
  <li>
    <p>target_precompile_headers: pch 설정</p>
  </li>
  <li>find_package: 외부 라이브러리나 모듈을 찾음. 경로나 매개변수를 설정해 줘야 함</li>
  <li>
    <p>target_link_libraries: 프로젝트에 라이브러리 연결</p>
  </li>
  <li>target_include_directories: 헤더 파일 경로 지정</li>
  <li>target_compile_options: 컴파일 옵션 설정</li>
  <li>
    <p>target_compile_definitions: 매크로 변수 설정</p>
  </li>
  <li>
    <p>set_target_properties: 빌드 결과물의 경로를 명시적으로 지정해 정리된 구조를 유지</p>
  </li>
  <li>add_dependencies: 외부 라이브러리들이 먼저 빌드되도록 명시적 빌드 순서를 지정</li>
</ul>

<p>대부분 Makefile을 만들어보며 아는 설정들이었지만 새롭게 알게 된 것은 GLOB_RECURSE, target_precompile_headers 이다. Mac에서 Makefile을 작성할 때 보통 Wildcard(*)를 사용해 *.cpp 또는 *.h를 찾아왔었는데, CMake에도 이 기능을 하는 명령어가 있어서 좋았다. 하지만 실시간으로 파일이 추가/삭제 되는 경우는 잘 처리 못하니 주의해야 한다. PCH에 대해서는 처음 알게 됐다. PCH는 컴파일 속도를 향상하기 위해 자주 변하지 않는 헤더 파일들을 미리 컴파일해두고, 나중에 재사용하는 방식이다. STL의 무거운 헤더들이나 Windows.h 같은 헤더들을 미리 컴파일 해두면 빌드 속도를 향상할 수 있다.</p>

<h3 id="dependencycmake">Dependency.cmake</h3>
<p>CMake를 처음 써 본 입장에서 이게 가장 좋았다. 외부 라이브러리들을 미리 프로젝트에 포함시키는 방식이 아니라, 실시간으로 외부에서 가져온 후 build 디렉토리 아래에 include 설정과 링크만 해주면 사용할 수 있는 점이 너무 편했다. 프로젝트의 용량을 줄일 수 있는 아주 좋은 도구이다. 대부분의 라이브러리들은 git 주소를 통해 가져왔다.</p>

<div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ExternalProject 관련 명령어 셋 추가</span>
<span class="nb">include</span><span class="p">(</span>ExternalProject<span class="p">)</span>

<span class="c1"># Dependency 관련 변수 설정</span>
<span class="nb">set</span><span class="p">(</span>DEP_INSTALL_DIR <span class="si">${</span><span class="nv">PROJECT_BINARY_DIR</span><span class="si">}</span>/install<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>DEP_INCLUDE_DIR <span class="si">${</span><span class="nv">DEP_INSTALL_DIR</span><span class="si">}</span>/include<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIB_DIR <span class="si">${</span><span class="nv">DEP_INSTALL_DIR</span><span class="si">}</span>/lib<span class="p">)</span>

<span class="c1"># glfw</span>
<span class="nf">ExternalProject_Add</span><span class="p">(</span>
    dep_glfw
    GIT_REPOSITORY <span class="s2">"https://github.com/glfw/glfw.git"</span>
    GIT_TAG <span class="s2">"3.3.2"</span>
    GIT_SHALLOW 1
    UPDATE_COMMAND <span class="s2">""</span> PATCH_COMMAND <span class="s2">""</span> TEST_COMMAND <span class="s2">""</span>
    CMAKE_ARGS
        -DCMAKE_INSTALL_PREFIX=<span class="si">${</span><span class="nv">DEP_INSTALL_DIR</span><span class="si">}</span>
        -DGLFW_BUILD_EXAMPLES=OFF
        -DGLFW_BUILD_TESTS=OFF
        -DGLFW_BUILD_DOCS=OFF
<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIST <span class="si">${</span><span class="nv">DEP_LIST</span><span class="si">}</span> dep_glfw<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIBS <span class="si">${</span><span class="nv">DEP_LIBS</span><span class="si">}</span> glfw3<span class="p">)</span>

<span class="c1"># spdlog</span>
<span class="nf">ExternalProject_Add</span><span class="p">(</span>
    dep_spdlog
    GIT_REPOSITORY <span class="s2">"https://github.com/gabime/spdlog.git"</span>
    GIT_TAG <span class="s2">"v1.11.0"</span>
    GIT_SHALLOW 1
    UPDATE_COMMAND <span class="s2">""</span> PATCH_COMMAND <span class="s2">""</span> TEST_COMMAND <span class="s2">""</span>
    CMAKE_ARGS
        -DCMAKE_INSTALL_PREFIX=<span class="si">${</span><span class="nv">DEP_INSTALL_DIR</span><span class="si">}</span>
        -DSPDLOG_BUILD_EXAMPLES=OFF
        -DSPDLOG_BUILD_TESTS=OFF
        -DSPDLOG_BUILD_BENCH=OFF
        -DSPDLOG_BUILD_SHARED=OFF
<span class="p">)</span>

<span class="nb">set</span><span class="p">(</span>DEP_LIST <span class="si">${</span><span class="nv">DEP_LIST</span><span class="si">}</span> dep_spdlog<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIBS <span class="si">${</span><span class="nv">DEP_LIBS</span><span class="si">}</span> 
    $&lt;$&lt;CONFIG:Debug&gt;:spdlogd&gt;
    $&lt;$&lt;CONFIG:Release&gt;:spdlog&gt;
<span class="p">)</span>

<span class="c1"># imgui 추가</span>
<span class="nf">ExternalProject_Add</span><span class="p">(</span>
    dep_imgui
    GIT_REPOSITORY <span class="s2">"https://github.com/Very-Real-Engine/imgui.git"</span>
    GIT_TAG <span class="s2">"main"</span>
    GIT_SHALLOW 1
    UPDATE_COMMAND <span class="s2">""</span> PATCH_COMMAND <span class="s2">""</span> TEST_COMMAND <span class="s2">""</span>
    CMAKE_ARGS
        -DCMAKE_INSTALL_PREFIX=<span class="si">${</span><span class="nv">DEP_INSTALL_DIR</span><span class="si">}</span>
<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIST <span class="si">${</span><span class="nv">DEP_LIST</span><span class="si">}</span> dep_imgui<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIBS <span class="si">${</span><span class="nv">DEP_LIBS</span><span class="si">}</span> imgui<span class="p">)</span>

<span class="c1"># glm</span>
<span class="nf">ExternalProject_Add</span><span class="p">(</span>
	dep_glm
	GIT_REPOSITORY <span class="s2">"https://github.com/g-truc/glm"</span>
	GIT_TAG <span class="s2">"0.9.9.8"</span>
	GIT_SHALLOW 1
	UPDATE_COMMAND <span class="s2">""</span>
	PATCH_COMMAND <span class="s2">""</span>
    CMAKE_ARGS
        -DGLM_TEST_ENABLE=OFF  <span class="c1"># 🔥 GLM 테스트 코드 비활성화</span>
	TEST_COMMAND <span class="s2">""</span>
	INSTALL_COMMAND <span class="si">${</span><span class="nv">CMAKE_COMMAND</span><span class="si">}</span> -E copy_directory
		<span class="si">${</span><span class="nv">PROJECT_BINARY_DIR</span><span class="si">}</span>/dep_glm-prefix/src/dep_glm/glm
		<span class="si">${</span><span class="nv">DEP_INSTALL_DIR</span><span class="si">}</span>/include/glm
	<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIST <span class="si">${</span><span class="nv">DEP_LIST</span><span class="si">}</span> dep_glm<span class="p">)</span>

<span class="c1"># stb</span>
<span class="nf">ExternalProject_Add</span><span class="p">(</span>
	dep_stb
	GIT_REPOSITORY <span class="s2">"https://github.com/nothings/stb"</span>
	GIT_TAG <span class="s2">"master"</span>
	GIT_SHALLOW 1
	UPDATE_COMMAND <span class="s2">""</span>
	PATCH_COMMAND <span class="s2">""</span>
	CONFIGURE_COMMAND <span class="s2">""</span>
	BUILD_COMMAND <span class="s2">""</span>
	TEST_COMMAND <span class="s2">""</span>
	INSTALL_COMMAND <span class="si">${</span><span class="nv">CMAKE_COMMAND</span><span class="si">}</span> -E copy
		<span class="si">${</span><span class="nv">PROJECT_BINARY_DIR</span><span class="si">}</span>/dep_stb-prefix/src/dep_stb/stb_image.h
		<span class="si">${</span><span class="nv">DEP_INSTALL_DIR</span><span class="si">}</span>/include/stb/stb_image.h
	<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIST <span class="si">${</span><span class="nv">DEP_LIST</span><span class="si">}</span> dep_stb<span class="p">)</span>

<span class="c1"># assimp</span>
<span class="nf">ExternalProject_Add</span><span class="p">(</span>
	dep_assimp
	GIT_REPOSITORY <span class="s2">"https://github.com/assimp/assimp"</span>
	GIT_TAG <span class="s2">"v5.4.3"</span>
	GIT_SHALLOW 1
	UPDATE_COMMAND <span class="s2">""</span>
	PATCH_COMMAND <span class="s2">""</span>
	CMAKE_ARGS
		-DCMAKE_INSTALL_PREFIX=<span class="si">${</span><span class="nv">DEP_INSTALL_DIR</span><span class="si">}</span>
        -DCMAKE_BUILD_TYPE=$&lt;CONFIG&gt;
		-DBUILD_SHARED_LIBS=OFF
		-DASSIMP_BUILD_ASSIMP_TOOLS=OFF
		-DASSIMP_BUILD_TESTS=OFF
		-DASSIMP_INJECT_DEBUG_POSTFIX=ON
		-DASSIMP_BUILD_ZLIB=ON
	TEST_COMMAND <span class="s2">""</span>
<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIST <span class="si">${</span><span class="nv">DEP_LIST</span><span class="si">}</span> dep_assimp<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIBS <span class="si">${</span><span class="nv">DEP_LIBS</span><span class="si">}</span>
    $&lt;$&lt;CONFIG:Debug&gt;:assimp-vc143-mtd&gt;
    $&lt;$&lt;CONFIG:Release&gt;:assimp-vc143-mt&gt;
    $&lt;$&lt;CONFIG:Debug&gt;:zlibstaticd&gt;
    $&lt;$&lt;CONFIG:Release&gt;:zlibstatic&gt;
<span class="p">)</span>
	
<span class="c1"># yaml-cpp</span>
<span class="nf">ExternalProject_Add</span><span class="p">(</span>
    dep_yaml_cpp
    GIT_REPOSITORY <span class="s2">"https://github.com/jbeder/yaml-cpp.git"</span>
    GIT_TAG <span class="s2">"yaml-cpp-0.7.0"</span> 
    GIT_SHALLOW 1
    UPDATE_COMMAND <span class="s2">""</span>
    PATCH_COMMAND <span class="s2">""</span>
    CMAKE_ARGS
        -DCMAKE_INSTALL_PREFIX=<span class="si">${</span><span class="nv">DEP_INSTALL_DIR</span><span class="si">}</span>
        -DYAML_BUILD_SHARED_LIBS=OFF
        -DYAML_CPP_BUILD_TESTS=OFF
        -DYAML_CPP_BUILD_TOOLS=OFF
    TEST_COMMAND <span class="s2">""</span>
<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIST <span class="si">${</span><span class="nv">DEP_LIST</span><span class="si">}</span> dep_yaml_cpp<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIBS <span class="si">${</span><span class="nv">DEP_LIBS</span><span class="si">}</span>
    $&lt;$&lt;CONFIG:Debug&gt;:yaml-cppd&gt;
    $&lt;$&lt;CONFIG:Release&gt;:yaml-cpp&gt;
<span class="p">)</span>

<span class="c1"># Mono</span>
<span class="nf">ExternalProject_Add</span><span class="p">(</span>
    dep_mono
    GIT_REPOSITORY <span class="s2">"https://github.com/Very-Real-Engine/ALE_mono.git"</span>
    GIT_TAG <span class="s2">"main"</span>
    GIT_SHALLOW 1
    UPDATE_COMMAND <span class="s2">""</span>
    PATCH_COMMAND <span class="s2">""</span>
    CONFIGURE_COMMAND <span class="s2">""</span> 
    BUILD_COMMAND <span class="s2">""</span>     
    INSTALL_COMMAND      
        <span class="si">${</span><span class="nv">CMAKE_COMMAND</span><span class="si">}</span> -E copy_directory
        &lt;SOURCE_DIR&gt;/mono  
        <span class="si">${</span><span class="nv">DEP_INCLUDE_DIR</span><span class="si">}</span>/mono
        COMMAND <span class="si">${</span><span class="nv">CMAKE_COMMAND</span><span class="si">}</span> -E copy
        &lt;SOURCE_DIR&gt;/Debug/libmono-static-sgen.lib
        <span class="si">${</span><span class="nv">DEP_INSTALL_DIR</span><span class="si">}</span>/lib/libmono-static-sgen-debug.lib
        COMMAND <span class="si">${</span><span class="nv">CMAKE_COMMAND</span><span class="si">}</span> -E copy
        &lt;SOURCE_DIR&gt;/Release/libmono-static-sgen.lib
        <span class="si">${</span><span class="nv">DEP_INSTALL_DIR</span><span class="si">}</span>/lib/libmono-static-sgen.lib
<span class="p">)</span>

<span class="c1"># Dependency 리스트 추가</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIST <span class="si">${</span><span class="nv">DEP_LIST</span><span class="si">}</span> dep_mono<span class="p">)</span>
<span class="c1"># Mono 라이브러리 경로 설정</span>
<span class="nb">set</span><span class="p">(</span>MONO_LIB_DEBUG <span class="si">${</span><span class="nv">DEP_INSTALL_DIR</span><span class="si">}</span>/lib/libmono-static-sgen-debug.lib<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>MONO_LIB_RELEASE <span class="si">${</span><span class="nv">DEP_INSTALL_DIR</span><span class="si">}</span>/lib/libmono-static-sgen.lib<span class="p">)</span>

<span class="c1"># CMake에서 빌드 타입에 따라 올바른 라이브러리를 링크</span>
<span class="nb">set</span><span class="p">(</span>DEP_LIBS <span class="si">${</span><span class="nv">DEP_LIBS</span><span class="si">}</span> 
    $&lt;$&lt;CONFIG:Debug&gt;:<span class="si">${</span><span class="nv">MONO_LIB_DEBUG</span><span class="si">}</span>&gt;
    $&lt;$&lt;CONFIG:Release&gt;:<span class="si">${</span><span class="nv">MONO_LIB_RELEASE</span><span class="si">}</span>&gt;
<span class="p">)</span>
</code></pre></div></div>

<p>내가 해줘야 했던 일은 각 라이브러리에 포함된 CMake 파일을 파악해, 어떤 옵션으로 빌드해야 할지 정해주는 것이었다. 또한 Debug, Release 빌드에 따라 다르게 설정해줘야 했다. 대부분 반복되는 작업이어서 크게 어렵지는 않았다. 까다로웠던 점은 두 가지 정도 있는데, 먼저 imgui나 mono는 CMake 파일이 없어서 직접 작성해줘야 했던 점이다. 당연히 CMake가 있는 줄 알고 빌드를 하다가 계속 오류가 생겨 헤맸던 기억이 있다. 또 까다로웠던 점은 glm은 CMAKE_ARGS -DGLM_TEST_ENABLE=OFF 이 옵션이 다른 라이브러리의 테스트 코드 비활성화 약간 달랐던 점이다. 그냥 무지성으로 옵션들을 복사 붙여넣기 하다가 혼났던 기억이 있다.</p>

<h3 id="al-scriptcore">AL-ScriptCore</h3>
<p>ScriptCore는 Scripting의 규칙을 명시해 놓은 프로젝트이다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AL-ScriptCore/
└── src
    ├── Input.cs
    ├── InternalCalls.cs
    ├── KeyCode.cs
    ├── Scene
    ├── Vector2.cs
    ├── Vector3.cs
    └── Vector4.cs
</code></pre></div></div>

<p>이 프로젝트는 .NET 기반 C# 프로젝트이기 때문에 약간 다르게 설정해줘야 했다. Debug/Release 별로 Visual Studio에서 어떻게 build 할지 옵션을 설정해줬다.</p>

<h3 id="cmakeliststxt-1">CMakeLists.txt</h3>
<div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Debug / Release 빌드에 따라 값 설정</span>
<span class="nb">if</span><span class="p">(</span>CMAKE_BUILD_TYPE STREQUAL <span class="s2">"Debug"</span><span class="p">)</span>
    <span class="c1"># Visual StudioDebug 빌드 설정</span>
    <span class="nb">set_target_properties</span><span class="p">(</span>AL-ScriptCore PROPERTIES
        VS_GLOBAL_Optimize <span class="s2">"false"</span>
        VS_GLOBAL_DebugSymbols <span class="s2">"true"</span>
        VS_DOTNET_TARGET_FRAMEWORK_VERSION <span class="si">${</span><span class="nv">DOTNET_FRAMEWORK_VERSION</span><span class="si">}</span>
    <span class="p">)</span>
<span class="nb">else</span><span class="p">()</span>
    <span class="nb">set_target_properties</span><span class="p">(</span>AL-ScriptCore PROPERTIES
        VS_GLOBAL_Optimize <span class="s2">"true"</span>
        VS_GLOBAL_DebugSymbols <span class="s2">"false"</span>
        VS_DOTNET_TARGET_FRAMEWORK_VERSION <span class="si">${</span><span class="nv">DOTNET_FRAMEWORK_VERSION</span><span class="si">}</span>
    <span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="sandbox">Sandbox</h3>
<p>Sandbox는 Editor의 소스코드 및 엔진에 필요한 각종 에셋(폰트, Skybox)과 자원(Play, Stop, Pause 버튼 이미지, File Icon), SandboxProjects 들이 모여있는 프로젝트이다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sandbox/
├── Project
├── Resources
├── assets
├── mono
└── src
</code></pre></div></div>

<h3 id="sandbox-project">Sandbox Project</h3>
<p>Sandbox Project는 엔진으로 생성된 프로젝트이다. Unity를 떠올려봤을 때 Unity Hub에서 원하는 프로젝트를 설정해 생성할 수 있는 것처럼, ALEngine도 Sandbox 아래에 정해놓은 형식대로 폴더와 Scene 파일을 배치하면 프로젝트를 생성할 수 있다. 환경 설정을 하며 가장 아쉬웠던 부분인데, 가장 위에 배치되어 있는 CMake 파일에서 설정만 잘 해놓거나 직접 프로젝트를 만들 수 있는 Unity Hub 같은 도구를 만들었다면 프로젝트 생성을 자동화 할 수 있었을 텐데… 그 부분이 참 아쉽다. 이 프로젝트의 CMake는 게임 코드를 빌드하는 역할을 수행한다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sandbox/Project
└── Assets
    ├── Models
    ├── Scenes
    └── Scripts
</code></pre></div></div>

<h3 id="main-cmakeliststxt">Main CMakeLists.txt</h3>
<p>가장 처음에 실행되는 CMake이다. 윈도우가 아닐 때는 실행이 안되게 처리해 놓았다. 만약에 Cross Platform을 지원한다면 이 부분을 좀 더 자세하게 작성해야 할 것이다.</p>

<div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cmake_minimum_required</span><span class="p">(</span>VERSION 3.20<span class="p">)</span>
<span class="nb">project</span><span class="p">(</span>GameEngine<span class="p">)</span>

<span class="nb">if</span><span class="p">(</span>NOT WIN32<span class="p">)</span>
    <span class="nb">message</span><span class="p">(</span>FATAL_ERROR <span class="s2">"This project can only be built on Windows."</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>

<span class="nb">message</span><span class="p">(</span>STATUS <span class="s2">"Building on Windows environment."</span><span class="p">)</span>

<span class="c1"># C++ 표준 설정</span>
<span class="nb">set</span><span class="p">(</span>CMAKE_CXX_STANDARD 17<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>CMAKE_CXX_STANDARD_REQUIRED ON<span class="p">)</span>
<span class="nb">set</span><span class="p">(</span>SANDBOXPROJECT <span class="s2">"Sandbox/Project/Assets/Scripts"</span><span class="p">)</span>

<span class="c1"># 서브 디렉토리 추가</span>
<span class="nb">add_subdirectory</span><span class="p">(</span>AL-ScriptCore<span class="p">)</span>
<span class="nb">add_subdirectory</span><span class="p">(</span>AL<span class="p">)</span>
<span class="nb">add_subdirectory</span><span class="p">(</span><span class="si">${</span><span class="nv">SANDBOXPROJECT</span><span class="si">}</span><span class="p">)</span>
<span class="nb">add_subdirectory</span><span class="p">(</span>Sandbox<span class="p">)</span>
</code></pre></div></div>

<h2 id="느낀-점">느낀 점</h2>
<p>Makefile이 아닌 CMake를 사용해 빌드해본 것은 처음이었는데, 참 편한 점이 많다고 느꼈다. 프로젝트 진행하는 동안 팀원들 대부분 문제 없이 빌드를 할 수 있었다. 나는 기본적인 기능만 하는 CMake를 작성했지만, 모든 환경에서 돌아가는 프로그램을 작성하려면 CMake도 환경별로 분기를 엄청 자세하게 나누고, 예외 처리도 잘 해야겠다는 생각이 들었다. 나중에 또 CMake를 작성할 일이 있다면 병렬 설정을 통해 빌드 속도를 높이는 작업도 해보고 싶다.</p>


    
    <div class="pt-5">
      
    </div>
    
  </div>

  <!-- 사이드바 영역 -->
  <div class="col-md-3">
    <div class="tags-list">
    <h3>📂 태그 목록</h3>
    <ul>
      
      
        
        
        <li>
          <a href="/blog/tags#ai">
            AI (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#automation">
            Automation (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#cmake">
            CMake (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#civilization">
            Civilization (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#claude">
            Claude (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#development">
            Development (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#game-engine">
            Game Engine (9)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#gameanalysis">
            GameAnalysis (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#graphics">
            Graphics (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#http">
            HTTP (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#http">
            Http (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#imgui">
            ImGui (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#makefile">
            Makefile (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#multiplexing">
            Multiplexing (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#network">
            Network (3)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#physics">
            Physics (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#scripting">
            Scripting (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#server">
            Server (2)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#systemdesign">
            SystemDesign (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#tcp-ip">
            TCP/IP (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#unity">
            Unity (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#kqueue">
            kqueue (1)
          </a>
        </li>
      
        
        
        <li>
          <a href="/blog/tags#yaml-cpp">
            yaml-cpp (1)
          </a>
        </li>
      
    </ul>
  </div>
  
  </div>
</div>

</div>
  </main>
  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    <i class="fas fa-code"></i> with <i class="fas fa-heart"></i>
    by <strong>jasongoo827</strong>
  </small>

  <div class="container-fluid justify-content-center"><a class="social mx-1"  href="mailto:jasongoo@naver.com"
       style="color: #6c757d"
       onMouseOver="this.style.color='#db4437'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fas fa-envelope fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.github.com/jasongoo827"
       style="color: #6c757d"
       onMouseOver="this.style.color='#333333'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-github fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.linkedin.com/in/jae-woo-goo-38bba5353"
       style="color: #6c757d"
       onMouseOver="this.style.color='#007bb5'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-linkedin-in fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.youtube.com/channel/UC7E6rQHpg4e_c6VHXO0G0XQkoo"
       style="color: #6c757d"
       onMouseOver="this.style.color='#ff0000'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-youtube fa-1x"></i>
    </a>

</div><small id="attribution">
    theme <a href="https://github.com/yousinix/portfolYOU">portfolYOU</a>
  </small>

</footer>

  
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>
</body>

</html>